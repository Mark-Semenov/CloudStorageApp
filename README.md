# CloudStorageApp

Для того чтобы запустить приложение, необходимо проделать следующие манипуляции:

1. Загрузить сервер приложений Wildfly (Jakarta EE Full & Web Distribution)
https://www.wildfly.org/downloads/

2. Далее для доступа в панель администратора необходимо добавить пользователя:
  2.1.Открыть командную строку и перейти в директорию ...\wildfly-[version].Final\bin
	2.2.Затем запустить сценарий add-user.bat (для Windows) add-user.sh (Mac, Linux) 
	Пример: S:\wildfly-23.0.0.Final\wildfly-23.0.0.Final\bin]./add-user.sh
  Следовать сценарию.
  
3. После добавления пользователя необходимо загрузить JDBC драйвер БД
(в данном случае postgresql-42.2.19.jar, https://jdbc.postgresql.org/download.html)
в директорию: ...\wildfly-version.Final\standalone\deployments
Драйвер понадобится для взаимодействия сервера приложений с БД.

4. После загрузки драйвера необходимо запустить сервер приложений.
Для этого в командной строке необходимо перейти в директорию ...\wildfly-[version].Final\bin
и ввести команду standalone.bat (для Windows) или standalone.sh (Mac, Linux)

5. После запуска, перейти в браузер и ввести в адресной строке http://localhost:8080
Если сервер запустился, вы увидите привественную страницу, в которой нужно перейти по ссылке Administration Console

6. Приложение работает с БД. Для того чтобы ее подключить, необходимо произвести некоторые настройки на сервере приложений. Мы уже загрузили драйвер, теперь необходимо 
в панели администртора перейти в Configuration - Subsystems - Datasources & Drivers - Datasources 
	6.1. В колонке Datasource необходимо добавить источник данных, для этого жмем + и выбираем Add Datasource
	6.2 Выбираем PostgreSQL и жмем next
		6.2.1 Видим заполненные поля Name: PostgresDS и JNDI Name: java:/PostgresDS ничего не меняя жмем next
		6.2.2 В поле Driver Name выбираем ранее загруженный JDBC драйвер postgresql-42.2.19.jar и жмем next, оставляя остальные поля без изменений
		6.2.3 В поле Connection URL пишем jdbc:postgresql://localhost:5432/cloud_storage, где cloud_storage - база данных, которую нужно будет создать в postgresql
			6.2.3.1 Указываем имя пользователя в postgresql и пароль, жмем next.
		6.2.4 На следующей странице будет предложено проверить соединение с БД (Test connection)
		6.2.5 Видим ранее заполненные поля. Жмем кнопку finish, источник данных добавлен.

7. Теперь нужно настроить систему безопастности JAAS. Для этого нужно запустить скрипт security.cli, который находится в папке: src/main/resources
	7.1. Открываем командную строку, переходим в директорию ...\wildfly-[version].Final\bin и водим jboss-cli.bat --connect --file=путь_до_файла/security.cli
	7.2. В случае успеха видим сообщение: 
		The batch executed successfully{
  		 "outcome" => "success",
   		 "result" => undefined
		}

8. Для работы приложения необходимо установить PostgreSQL (https://www.postgresql.org/download/) и создать БД cloud_storage
9. После настройки сервера приложений и БД можно загрузить репозиторий приложения на локальную машину
	9.1. Запустить среду разработки 
	9.2. Добавить конфигурацию Add Configuration - Maven 
		9.2.1. В стороке Command line прописать clean install wildfly:deploy
		9.2.2. Задеплоить приложение. Перейти в браузер и ввести: http://localhost:8080/storage-demo-app-1.0-SNAPSHOT/
	

10. После запуска приложения необходимо авторизоваться. Т.к. аккаунта еще нет, перейдите по ссылке Sign Up и зарегистрируйтесь. 
В случае успеха, будет загружена страница файлого хранилища.
  10.1. Приложение разделено на 2 смысловые части: слева дерево каталогов (изначально пустое), справа таблица файлов. Управлять деревом (CRUD операции) можно с помощью контекстного меню.
	10.2. Файлы можно загружать в определенную папку, для этого нужно ее выделить и нажать кнопку Choose. Заруженные файлы будут отображаться в таблице справа только когда данная папка выделена.
	10.3. Управлять файлами (удалить, загрузить) можно в таблице справа.

11. Дополнительно можно снять ограничение сервера приложений на размер в 10 мб для загружаемых файлов. Для этого необходимо в командной строке из директории ...\wildfly-[version].Final\bin запустить сценарий jboss-cli.bat --connect --file=путь_до_файла/increase-upload-file-size.cli (скрипт increase-upload-file-size.cli можно найти в src/main/resources)
